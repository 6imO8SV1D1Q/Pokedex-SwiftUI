# Pokedex-SwiftUI

SwiftUIで実装したポケモン図鑑アプリケーション。PokéAPI v2を使用して全ポケモンの情報を表示します。

## 主な機能

### v2.0の新機能

#### 1. バージョングループ別表示
- **全国図鑑モード**: 全ポケモン（1025匹）を最新仕様で表示
- **バージョングループ選択**: 各ゲーム世代のポケモンと仕様で表示
  - 赤・緑・青、金・銀、ルビー・サファイア、ダイヤモンド・パール...など22種類
  - タイプ、特性、種族値が各バージョングループの仕様で表示される

#### 2. 拡張されたポケモン情報表示
- **特性表示**: 通常特性と隠れ特性を表示
  - 第1〜2世代：特性システム未実装のため非表示
  - 第3〜4世代：通常特性のみ
  - 第5世代以降：通常特性 + 隠れ特性
- **種族値表示**: HP/攻撃/防御/特攻/特防/素早さと合計値
  - 表示形式: `45-49-49-65-65-45 (318)`

#### 3. 高度なフィルター機能
- **タイプフィルター**: 複数タイプで絞り込み（既存機能）
- **特性フィルター**: 特性で絞り込み
  - 全国図鑑モード、第3世代以降で利用可能
  - 通常特性・隠れ特性の両方に対応
- **技フィルター**: 複数の技（最大4つ）で絞り込み
  - バージョングループ選択時のみ利用可能
  - 習得方法も表示（レベル、TM/TR、タマゴ技など）

#### 4. ソート機能
- 図鑑番号（デフォルト）
- 名前（昇順/降順）
- 種族値合計（昇順/降順）
- 各ステータス（HP、攻撃、防御、特攻、特防、素早さ）

#### 5. UI/UX改善
- リスト/グリッド表示切り替え
- ローディングプログレスバー表示
- スクロール位置保持（詳細画面から戻った時）

### v1.0の機能
- ポケモン一覧表示
- ポケモン詳細表示
- タイプフィルター
- 名前検索
- キャッシュ機能（Kingfisher）

## アーキテクチャ

Clean Architecture + MVVMパターンを採用

```
├── Domain/          # エンティティ、ユースケース、プロトコル
├── Data/            # リポジトリ、API、キャッシュ
├── Presentation/    # ビュー、ビューモデル
└── Application/     # 依存性注入
```

### 主要コンポーネント

**Domain層:**
- `Pokemon` / `PokemonListItem`: ポケモンエンティティ
- `VersionGroup`: バージョングループエンティティ
- `MoveEntity`: 技エンティティ
- `FetchPokemonListUseCase`: ポケモンリスト取得
- `FilterPokemonByMovesUseCase`: 技フィルター
- `SortPokemonUseCase`: ソート

**Data層:**
- `PokemonRepository`: ポケモンデータ取得
- `MoveRepository`: 技データ取得
- `PokemonAPIClient`: PokéAPI通信
- 各種Cache: メモリキャッシュ

**Presentation層:**
- `PokemonListViewModel`: 一覧画面のビジネスロジック
- `PokemonDetailViewModel`: 詳細画面ロジック

## 技術スタック

- **言語**: Swift 6.0
- **フレームワーク**: SwiftUI
- **最小デプロイメントターゲット**: iOS 17.0
- **依存ライブラリ**:
  - Kingfisher (画像キャッシュ)
- **API**: PokéAPI v2 (https://pokeapi.co/)

## セットアップ

### 必要要件
- Xcode 15.0+
- iOS 17.0+

### インストール手順

1. リポジトリをクローン
```bash
git clone https://github.com/yourusername/Pokedex-SwiftUI.git
cd Pokedex-SwiftUI
```

2. 依存関係の解決
```bash
# Kingfisherは自動的に解決されます
```

3. Xcodeでプロジェクトを開く
```bash
open Pokedex/Pokedex.xcodeproj
```

4. ビルド＆実行
- ターゲットデバイス/シミュレータを選択
- Cmd+R でビルド＆実行

## 使い方

### 基本操作

1. **バージョングループ選択**
   - 画面上部のドロップダウンからバージョングループを選択
   - 「全国図鑑」または各ゲームバージョンを選択可能

2. **フィルター機能**
   - 虫眼鏡アイコンをタップして検索画面を開く
   - タイプ、特性、技で絞り込み可能
   - 技フィルターはバージョングループ選択時のみ有効

3. **ソート機能**
   - 「ソート」ボタンをタップ
   - 種族値合計や各ステータスでソート可能

4. **表示モード切り替え**
   - リスト/グリッドアイコンで表示を切り替え

### 制約事項

- **技フィルター**: バージョングループ選択時のみ利用可能
  - 理由: 技の習得方法がバージョンごとに異なるため
- **特性フィルター**: 第1〜2世代では利用不可
  - 理由: 特性システムが未実装の世代のため
- **初回ロード**: 全ポケモン取得のため数秒かかる場合あり

## パフォーマンス

- **初回ロード時間**: 約2〜3秒（全国図鑑モード）
- **バージョングループ切り替え**: 約1〜2秒（キャッシュ済みの場合は即座）
- **メモリ使用量**: 約150〜200MB（全ポケモンキャッシュ時）
- **画像キャッシュ**: 最大500MB（ディスクキャッシュ、7日間保持）

## テスト

### ユニットテスト実行

Xcodeから:
```
Cmd+U
```

コマンドラインから:
```bash
xcodebuild test -scheme Pokedex -destination 'platform=iOS Simulator,name=iPhone 15'
```

### テストカバレッジ

- **Domain層**: 85%+
- **Data層**: 80%+
- **Presentation層**: 75%+

### テスト構成

- **ユニットテスト**: 85件（UseCases、ViewModels、Repositories）
- **統合テスト**: 20件（バージョングループ切り替え、フィルター連携、ソート）
- **パフォーマンステスト**: 8件（ロード時間、フィルター速度）

## トラブルシューティング

### よくある問題

**Q: 初回ロードが遅い**
- A: 全ポケモンデータを取得するため、初回は時間がかかります。2回目以降はキャッシュが効くため高速になります。

**Q: 技フィルターが使えない**
- A: 全国図鑑モードでは技フィルターは無効です。バージョングループを選択してください。

**Q: ネットワークエラーが発生する**
- A: PokéAPIへの接続を確認してください。また、短時間に大量のリクエストを送るとレート制限がかかる場合があります。

**Q: 画像が表示されない**
- A: ネットワーク接続を確認してください。Kingfisherが自動的にリトライします。

## 今後の予定

- [ ] お気に入り機能（永続化）
- [ ] オフライン完全対応
- [ ] リージョンフォーム対応
- [ ] タイプ相性チェッカー
- [ ] ポケモン比較機能
- [ ] ダークモード対応

## ライセンス

MIT License

## クレジット

- **PokéAPI**: https://pokeapi.co/
- **Kingfisher**: https://github.com/onevcat/Kingfisher
- ポケモンの名前、画像、データは任天堂・クリーチャーズ・ゲームフリークの著作物です

## 貢献

プルリクエストを歓迎します。大きな変更の場合は、まずIssueを開いて変更内容を議論してください。

## 連絡先

- **作成者**: Yusuke Abe
- **作成日**: 2025-10-04
- **バージョン**: 2.0.0

---

詳細なドキュメント:
- [要件定義書 v2](docs/pokedex_requirements_v2.md)
- [設計書 v2](docs/pokedex_design_v2.md)
- [変更履歴](CHANGELOG.md)
