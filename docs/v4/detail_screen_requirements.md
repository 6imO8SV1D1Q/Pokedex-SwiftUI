# ポケモン詳細画面UI整理 - 要件定義書 v4.0

**プロジェクト:** Pokedex-SwiftUI
**対象機能:** ポケモン詳細画面のUI/UX改善
**作成日:** 2025-10-21
**ステータス:** 要件定義中

---

## 1. 背景と目的

### 現状の課題
- 詳細画面の情報が縦スクロールで長く、見にくい
- 情報が整理されておらず、目的の情報を探しにくい
- 生態情報とバトル情報が混在している

### 改善の方針
- タブ構成に変更し、情報を目的別に分類
- 生態情報（図鑑的データ）とバトル情報（対戦用データ）を分離
- レイアウトを最適化し、視認性を向上

---

## 2. タブ構成

### 2.1 全体構成

**2タブ構成を採用:**

#### 📖 生態タブ
生き物としてのポケモンの生態・図鑑情報

#### ⚔️ バトルタブ
対戦で必要となるバトルデータ

---

## 3. 各タブの詳細仕様

### 3.1 📖 生態タブ（✅ 確定）

#### 表示内容（上から順）
1. **スプライト＋基本情報**（横並びレイアウト）
   - 左側: スプライト画像（コンパクトサイズ）
   - 右側: 基本情報
     - 図鑑番号（例: #001）
     - ポケモン名（日本語）
     - タイプバッジ
     - 身長（m）
     - 体重（kg）
   - 色違いトグル（スプライト下部または右側情報の下）

2. **繁殖情報**
   - 性別比（♂/♀比率、性別不明）
   - タマゴグループ

3. **図鑑説明文**
   - 説明テキスト
   - 出典バージョン表示

4. **フォーム選択**（複数フォームがある場合のみ）
   - フォーム一覧
   - 選択UI（ドロップダウンまたはセグメント）

5. **進化チェーン**
   - ツリー構造での進化表示
   - 進化条件表示
   - タップで該当ポケモンへ遷移

#### レイアウト方針
- 全体: 縦スクロール
- スプライト＋基本情報のみ横並び
- 以降のセクションは縦積み

---

### 3.2 ⚔️ バトルタブ（✅ 確定）

#### 表示内容（上から順）
1. **実数値計算**（新規・独立セクション）
   - 開閉可能（ExpandableSection）
   - レベル、努力値、個体値、性格の入力UI
   - 計算結果の実数値表示（HP、攻撃、防御、特攻、特防、素早さ）

2. **タイプ相性**
   - 開閉可能（ExpandableSection）
   - 弱点（2倍、4倍）
   - 半減（1/2倍、1/4倍）
   - 無効（0倍）

3. **種族値**
   - 開閉可能（ExpandableSection）
   - 種族値表示（HP、攻撃、防御、特攻、特防、素早さ、合計）

4. **特性**
   - 開閉可能（ExpandableSection）
   - 特性名（通常特性、隠れ特性）
   - 効果説明文

5. **覚える技**
   - 開閉可能（ExpandableSection）
   - 技リスト
   - 「フィルター」ボタン → モーダルで詳細フィルター表示
   - 習得方法フィルター（必須）
   - 詳細フィルター（タイプ、分類、威力、命中率、PP、優先度、対象）

#### レイアウト方針
- すべて縦スクロール
- 全セクションが開閉可能（ExpandableSection）
- デフォルト展開状態は実装時に調整

---

## 4. 技フィルター機能（詳細仕様）（✅ 確定）

### 4.1 目的
- **ライバルが覚えない技を見つけやすくする**
- ポケモン一覧の絞り込みと同等レベルの詳細フィルター

### 4.2 必須フィルター条件
- ✅ 習得方法（レベルアップ、マシン、タマゴ、教え技など）

### 4.3 詳細フィルター条件（ポケモン絞り込みと同等）
- タイプ
- 分類（物理/特殊/変化）
- 威力（範囲指定）
- 命中率（範囲指定）
- PP（範囲指定）
- 優先度
- 対象（単体/全体/相手全体など）

### 4.4 フィルターUIの配置（✅ 確定）
- ✅ **案2を採用**: モーダルで表示（「フィルター」ボタン）
- 覚える技セクション内に「フィルター」ボタンを配置
- タップするとフィルター設定画面をモーダル表示
- 既存のポケモン一覧フィルターUIと同様の形式

---

## 5. タブUI実装方式（✅ 確定）

### 採用方式
- ✅ **案1を採用**: カスタムセグメントコントロール（上部にタブ）
- 詳細画面の最上部に「生態 | バトル」のセグメント配置
- タブ切り替えでコンテンツエリアが切り替わる

### 不採用
- ❌ 案2: SwiftUI標準TabView（下部タブバー）
  - 理由: 詳細画面には上部セグメント方式が適している

---

## 6. 生態タブのレイアウト詳細（✅ 確定）

### スプライト＋基本情報レイアウト
- ✅ **案1を採用**: 基本情報をすべて右側に配置

**レイアウト構成:**
```
┌──────────┬─────────────────┐
│          │ #001            │
│          │ フシギダネ       │
│ スプライト │ [くさ] [どく]   │
│          │ 高さ: 0.7m      │
│          │ 重さ: 6.9kg     │
└──────────┴─────────────────┘
```

- スプライト: 左側、コンパクトサイズ
- 右側に縦並びで配置:
  - 図鑑番号
  - ポケモン名
  - タイプバッジ
  - 身長
  - 体重

### 色違いトグル
- スプライトの下部または右側情報の下に配置

---

## 7. 実数値計算UI（✅ 確定）

### 配置場所
- ✅ **案2を採用**: 別の独立したセクション（「実数値計算」）
- バトルタブ内に独立したセクションとして配置
- 開閉可能なExpandableSectionで実装

### セクション順序（バトルタブ内）
1. 実数値計算（新規セクション）
2. タイプ相性
3. 種族値
4. 特性
5. 覚える技

### 入力UI
以下の入力欄を提供:
- レベル（スライダーまたは数値入力）
- 各ステータスの努力値（0〜252）
- 各ステータスの個体値（0〜31）
- 性格（ドロップダウンまたはピッカー）

### 表示内容
- 入力値に基づいた実数値を計算して表示
- HP、攻撃、防御、特攻、特防、素早さの6項目
- 性格補正の影響を反映

**注:** 詳細なUIデザインは実装後に調整

---

## 8. 削除する機能

### 出現場所セクション
- **理由:** データが取得できていないことが多い
- **対応:** 当面は表示しない（実装は残す）

---

## 9. 次のステップ

### フェーズ1: 要件確定（✅ 完了）
- [x] タブUI実装方式の決定（A）→ 案1: 上部セグメント
- [x] 生態タブのレイアウト詳細の決定（B）→ 案1: 基本情報すべて右側
- [x] 技フィルターUIの配置決定（C）→ 案2: モーダル表示
- [x] 実数値計算UIの配置・デザイン方針決定（D）→ 案2: 独立セクション

### フェーズ2: 設計（🔄 進行中）
- [ ] 生態タブの詳細設計
- [ ] バトルタブの詳細設計
- [ ] 技フィルター機能の詳細設計
- [ ] 実数値計算UIの詳細設計

### フェーズ3: 実装
- [ ] タブ構成の実装
- [ ] 生態タブの実装
- [ ] バトルタブの実装
- [ ] 技フィルター機能の実装
- [ ] 実数値計算UIの実装

### フェーズ4: テスト・調整
- [ ] ビルド・動作確認
- [ ] UI/UXの微調整
- [ ] ユーザーフィードバック反映

---

## 10. 関連ドキュメント

- `docs/pokedex_requirements_v3.md` - v3.0要件定義書
- `docs/pokedex_design_v3.md` - v3.0設計書
- `CLAUDE.md` - 開発ガイドライン

---

## 更新履歴

| 日付 | 内容 |
|------|------|
| 2025-10-21 | 初版作成、要件定義開始 |
| 2025-10-21 | フェーズ1要件確定（タブUI方式、レイアウト、フィルター配置、実数値UI配置） |
